---
pcx_content_type: concept
title: 分支部署控制
---

# 分支部署控制

连接到 git 仓库后，Pages 允许你控制要自动部署到哪些环境和分支。默认情况下，Pages 会在你提交到生产环境或预览环境的任何时候触发部署。不过，有了分支部署控制，你可以根据每个项目的喜好配置自动部署。

## 生产分支控制

{{<Aside type="warning" header="Direct Upload">}}

{{<render file="_prod-branch-update.md" productFolder="/pages/">}}

{{</Aside>}}

要配置部署选项，请进入 Pages 项目 > **设置**> **构建和部署**> **配置生产部署**。Pages 默认会将生产环境设置为首次推送的分支，但你也可以选择将生产环境设置为其他分支。

你还可以通过选中 **启用生产分支自动部署**复选框，在生产分支上启用或禁用自动部署行为。你必须保存设置，新的生产分支控制才能生效。

## 预览分支控制

配置自动预览部署时，有三个选项可供选择。

* **All non-Production branches 所有非生产分支**：默认情况下，Pages 会自动将所有提交部署到预览分支。
* **None 无**：关闭所有预览分支的自动构建。
* **Custom branches 自定义分支**：自定义某些预览分支的自动部署。

### 自定义预览分支控制

通过选择 **自定义分支**，你可以在所提供的配置字段中指定希望从自动部署中包括或排除的分支。配置字段有两种填写方式：

* **静态分支名称**：输入要包含或排除的分支的准确名称(例如，暂存或开发)。
* **通配符语法**：使用通配符匹配多个分支。你可以在规则的开头或结尾指定通配符。配置的执行顺序是：(1) 排除，(2) 包括，(3) 跳过。页面会先处理排除配置，然后再处理包含配置。如果某个分支与这两种配置都不匹配，就会被跳过。

{{<Aside type="note" header="Wildcard syntax">}}

通配符 (`*`) 是一种在规则中使用的字符。它可以单独使用以匹配任何内容，也可以放在规则的开头或结尾，以便更好地控制分支配置。例如，如果要匹配所有以 `fix/` 开头的分支，可以创建规则 `fix/*` 来匹配 `fix/1`、`fix/bugs` 或 `fix/` 等字符串。

{{</Aside>}}


**示例 1：**

如果要使用通配符语法强制执行分支前缀，如 `fix/`、`feat/` 或 `chore/` ，可以使用以下规则包含或排除某些分支：

* 包括预览分支：
`fix/*`, `feat/*`, `chore/*`

* 排除预览分支：
``

在这里，Pages 将包括任何带有指定前缀的分支，并排除所有其他分支。在本例中，排除选项为空。


**示例 2：**

如果想阻止 [dependabot](https://github.com/dependabot) 为其创建的每个 PR 创建部署，可以通过以下方法排除这些分支：

* 包括预览分支：
`*`

* 排除预览分支：
`dependabot/*`

在这里，Pages 将包含所有分支，但以 `dependabot` 开头的分支除外。在本例中，`排除 `选项表示不构建任何 `dependabot/` 分支。


**例 3：**

如果只想部署版本预置分支，可以使用以下规则：

* 包括预览分支：
`release/*`

* 排除预览分支：
`*`

这将只部署以 `release/` 开头的分支。